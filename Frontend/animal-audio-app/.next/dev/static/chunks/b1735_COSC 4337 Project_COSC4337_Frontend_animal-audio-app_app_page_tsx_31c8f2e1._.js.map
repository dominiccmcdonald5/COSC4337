{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dorkd/OneDrive/Desktop/COSC%204337%20Project/COSC4337/Frontend/animal-audio-app/app/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useRef } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport axios from 'axios';\r\n\r\n// Dynamically import Plot to avoid SSR issues\r\nconst Plot = dynamic(() => import('react-plotly.js'), { ssr: false });\r\n\r\ninterface AnalysisResult {\r\n  biodiversity_score: number;\r\n  adi_score: number;\r\n  spectrogram_b64: string;\r\n  distribution_data: any;\r\n  benchmarks: { [key: string]: number };\r\n  filename: string;\r\n  duration: number;\r\n  sample_rate: number;\r\n}\r\n\r\nexport default function Home() {\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [analysisResult, setAnalysisResult] = useState<AnalysisResult | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string>('');\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      // Check file type\r\n      const allowedTypes = ['audio/wav', 'audio/mp3', 'audio/flac', 'audio/m4a', 'audio/ogg', 'audio/webm', 'video/webm'];\r\n      if (!allowedTypes.some(type => file.type.includes(type.split('/')[1]))) {\r\n        setError('Please select a valid audio file (WAV, MP3, FLAC, M4A, OGG, WebM)');\r\n        return;\r\n      }\r\n      \r\n      // Check file size (50MB limit)\r\n      if (file.size > 50 * 1024 * 1024) {\r\n        setError('File size must be less than 50MB');\r\n        return;\r\n      }\r\n      \r\n      setSelectedFile(file);\r\n      setError('');\r\n      setAnalysisResult(null);\r\n    }\r\n  };\r\n\r\n  const handleAnalyze = async () => {\r\n    if (!selectedFile) {\r\n      setError('Please select an audio file first');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('audio', selectedFile);\r\n\r\n      const response = await axios.post<AnalysisResult>(\r\n        'http://localhost:5000/analyze',\r\n        formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n          },\r\n          timeout: 60000, // 60 second timeout\r\n        }\r\n      );\r\n\r\n      setAnalysisResult(response.data);\r\n    } catch (err: any) {\r\n      console.error('Analysis error:', err);\r\n      if (err.code === 'ECONNREFUSED') {\r\n        setError('Cannot connect to analysis server. Please make sure the backend is running on port 5000.');\r\n      } else if (err.response?.data?.error) {\r\n        setError(`Analysis failed: ${err.response.data.error}`);\r\n      } else {\r\n        setError('Analysis failed. Please try again.');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleReset = () => {\r\n    setSelectedFile(null);\r\n    setAnalysisResult(null);\r\n    setError('');\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const getScoreColor = (score: number) => {\r\n    if (score >= 0.8) return 'text-green-600';\r\n    if (score >= 0.6) return 'text-yellow-600';\r\n    if (score >= 0.4) return 'text-orange-600';\r\n    return 'text-red-600';\r\n  };\r\n\r\n  const getScoreLabel = (score: number) => {\r\n    if (score >= 0.8) return 'Excellent Biodiversity';\r\n    if (score >= 0.6) return 'Good Biodiversity';\r\n    if (score >= 0.4) return 'Moderate Biodiversity';\r\n    if (score >= 0.2) return 'Low Biodiversity';\r\n    return 'Very Low Biodiversity';\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-linear-to-br from-green-50 to-blue-50 p-4\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-8\">\r\n          <h1 className=\"text-4xl font-bold text-gray-800 mb-4\">\r\n            ðŸŽµ Ecosystem Biodiversity Analyzer\r\n          </h1>\r\n          <p className=\"text-lg text-gray-600 max-w-2xl mx-auto\">\r\n            Upload an audio recording of an ecosystem to analyze its biodiversity using AI-powered acoustic analysis\r\n          </p>\r\n        </div>\r\n\r\n        {/* Upload Section */}\r\n        <div className=\"bg-white rounded-xl shadow-lg p-6 mb-6\">\r\n          <h2 className=\"text-2xl font-semibold mb-4\">Upload Audio File</h2>\r\n          \r\n          <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center\">\r\n            <input\r\n              ref={fileInputRef}\r\n              type=\"file\"\r\n              accept=\".wav,.mp3,.flac,.m4a,.ogg,.webm\"\r\n              onChange={handleFileSelect}\r\n              className=\"hidden\"\r\n              id=\"audio-upload\"\r\n            />\r\n            \r\n            <label htmlFor=\"audio-upload\" className=\"cursor-pointer\">\r\n              <div className=\"text-4xl mb-4\">ðŸŽ¤</div>\r\n              <p className=\"text-lg mb-2\">\r\n                {selectedFile ? selectedFile.name : 'Click to select an audio file'}\r\n              </p>\r\n              <p className=\"text-sm text-gray-500\">\r\n                Supported formats: WAV, MP3, FLAC, M4A, OGG, WebM (max 50MB)\r\n              </p>\r\n            </label>\r\n          </div>\r\n\r\n          {selectedFile && (\r\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\r\n              <p><strong>File:</strong> {selectedFile.name}</p>\r\n              <p><strong>Size:</strong> {(selectedFile.size / (1024 * 1024)).toFixed(2)} MB</p>\r\n              <p><strong>Type:</strong> {selectedFile.type}</p>\r\n            </div>\r\n          )}\r\n\r\n          {error && (\r\n            <div className=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\r\n              <p className=\"text-red-600\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"mt-6 flex gap-4 justify-center\">\r\n            <button\r\n              onClick={handleAnalyze}\r\n              disabled={!selectedFile || loading}\r\n              className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2\"\r\n            >\r\n              {loading ? (\r\n                <>\r\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n                  Analyzing...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  ðŸ”¬ Analyze Biodiversity\r\n                </>\r\n              )}\r\n            </button>\r\n            \r\n            {(selectedFile || analysisResult) && (\r\n              <button\r\n                onClick={handleReset}\r\n                className=\"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700\"\r\n              >\r\n                Reset\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Results Section */}\r\n        {analysisResult && (\r\n          <div className=\"space-y-6\">\r\n            {/* Biodiversity Score */}\r\n            <div className=\"bg-white rounded-xl shadow-lg p-6\">\r\n              <h2 className=\"text-2xl font-semibold mb-4\">Biodiversity Analysis Results</h2>\r\n              \r\n              <div className=\"grid md:grid-cols-2 gap-6\">\r\n                <div className=\"text-center\">\r\n                  <div className=\"text-6xl font-bold mb-2\">\r\n                    <span className={getScoreColor(analysisResult.biodiversity_score)}>\r\n                      {(analysisResult.biodiversity_score * 100).toFixed(1)}%\r\n                    </span>\r\n                  </div>\r\n                  <p className=\"text-xl font-semibold text-gray-700 mb-2\">\r\n                    Biodiversity Score\r\n                  </p>\r\n                  <p className={`text-lg font-medium ${getScoreColor(analysisResult.biodiversity_score)}`}>\r\n                    {getScoreLabel(analysisResult.biodiversity_score)}\r\n                  </p>\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div>\r\n                    <span className=\"font-semibold\">ADI Score:</span> {analysisResult.adi_score.toFixed(3)}\r\n                  </div>\r\n                  <div>\r\n                    <span className=\"font-semibold\">Duration:</span> {analysisResult.duration.toFixed(1)} seconds\r\n                  </div>\r\n                  <div>\r\n                    <span className=\"font-semibold\">Sample Rate:</span> {analysisResult.sample_rate} Hz\r\n                  </div>\r\n                  <div>\r\n                    <span className=\"font-semibold\">File:</span> {analysisResult.filename}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Spectrogram */}\r\n            {analysisResult.spectrogram_b64 && (\r\n              <div className=\"bg-white rounded-xl shadow-lg p-6\">\r\n                <h3 className=\"text-xl font-semibold mb-4\">Audio Spectrogram</h3>\r\n                <div className=\"text-center\">\r\n                  <img \r\n                    src={`data:image/png;base64,${analysisResult.spectrogram_b64}`}\r\n                    alt=\"Audio Spectrogram\"\r\n                    className=\"max-w-full h-auto rounded-lg shadow-md mx-auto\"\r\n                  />\r\n                </div>\r\n                <p className=\"text-sm text-gray-600 mt-2 text-center\">\r\n                  Frequency analysis showing acoustic patterns in your recording\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {/* Distribution Plot */}\r\n            {analysisResult.distribution_data && (\r\n              <div className=\"bg-white rounded-xl shadow-lg p-6\">\r\n                <h3 className=\"text-xl font-semibold mb-4\">Score Distribution & Benchmarks</h3>\r\n                <div className=\"h-96\">\r\n                  <Plot\r\n                    data={[\r\n                      analysisResult.distribution_data.histogram,\r\n                      analysisResult.distribution_data.user_score,\r\n                      ...analysisResult.distribution_data.benchmarks\r\n                    ]}\r\n                    layout={{\r\n                      title: 'Biodiversity Score Distribution',\r\n                      xaxis: { title: 'Biodiversity Score' },\r\n                      yaxis: { title: 'Frequency' },\r\n                      showlegend: true,\r\n                      height: 350\r\n                    }}\r\n                    config={{ \r\n                      displayModeBar: true,\r\n                      displaylogo: false,\r\n                      modeBarButtonsToRemove: ['pan2d', 'lasso2d', 'select2d']\r\n                    }}\r\n                    className=\"w-full h-full\"\r\n                  />\r\n                </div>\r\n                <p className=\"text-sm text-gray-600 mt-2\">\r\n                  Your recording's biodiversity score compared to various ecosystem benchmarks\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {/* Benchmarks Legend */}\r\n            <div className=\"bg-white rounded-xl shadow-lg p-6\">\r\n              <h3 className=\"text-xl font-semibold mb-4\">Ecosystem Benchmarks</h3>\r\n              <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                {Object.entries(analysisResult.benchmarks).map(([label, score]) => (\r\n                  <div key={label} className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\r\n                    <span className=\"font-medium\">{label.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase())}</span>\r\n                    <span className={`font-semibold ${getScoreColor(score)}`}>\r\n                      {(score * 100).toFixed(0)}%\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}